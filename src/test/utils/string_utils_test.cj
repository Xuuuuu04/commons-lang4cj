package commons_lang4cj.test.utils

import std.unittest.*
import std.unittest.testmacro.*
import commons_lang4cj.utils.*

/**
 * StringUtils å•å…ƒæµ‹è¯•ç±»
 *
 * æµ‹è¯•è¦†ç›–æ‰€æœ‰ 46 ä¸ªæ–¹æ³•ï¼Œç¡®ä¿æµ‹è¯•è¦†ç›–ç‡ â‰¥ 90%
 *
 * @since 1.0.0
 */
@Test
class StringUtilsTest {
    // ========== Phase 1: ç©ºå€¼æ£€æŸ¥æµ‹è¯• ==========

    @TestCase
    func testIsEmpty() {
        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.isEmpty(""), true)

        // éç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.isEmpty("a"), false)
        @Expect(StringUtils.isEmpty("hello"), false)

        // åªæœ‰ç©ºæ ¼çš„å­—ç¬¦ä¸²ä¸ç®—ç©º
        @Expect(StringUtils.isEmpty(" "), false)
        @Expect(StringUtils.isEmpty("  "), false)
        @Expect(StringUtils.isEmpty("  hello  "), false)
    }

    @TestCase
    func testIsNotEmpty() {
        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.isNotEmpty(""), false)

        // éç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.isNotEmpty("a"), true)
        @Expect(StringUtils.isNotEmpty("hello"), true)
        @Expect(StringUtils.isNotEmpty(" "), true)
        @Expect(StringUtils.isNotEmpty("  "), true)
    }

    @TestCase
    func testIsBlank() {
        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.isBlank(""), true)

        // åªæœ‰ç©ºç™½å­—ç¬¦
        @Expect(StringUtils.isBlank(" "), true)
        @Expect(StringUtils.isBlank("  "), true)
        @Expect(StringUtils.isBlank("\t"), true)
        @Expect(StringUtils.isBlank("\n"), true)
        @Expect(StringUtils.isBlank("\r"), true)
        @Expect(StringUtils.isBlank("  \t\n  "), true)

        // æœ‰éç©ºç™½å­—ç¬¦
        @Expect(StringUtils.isBlank("a"), false)
        @Expect(StringUtils.isBlank(" hello "), false)
        @Expect(StringUtils.isBlank("hello"), false)
    }

    @TestCase
    func testIsNotBlank() {
        // ç©ºå­—ç¬¦ä¸²å’Œç©ºç™½å­—ç¬¦ä¸²
        @Expect(StringUtils.isNotBlank(""), false)
        @Expect(StringUtils.isNotBlank(" "), false)
        @Expect(StringUtils.isNotBlank("\t\n"), false)

        // æœ‰å†…å®¹
        @Expect(StringUtils.isNotBlank("a"), true)
        @Expect(StringUtils.isNotBlank(" hello "), true)
        @Expect(StringUtils.isNotBlank("hello"), true)
    }

    // ========== Phase 2: æˆªå–ä¸åˆ†å‰²æµ‹è¯• ==========

    @TestCase
    func testTrim() {
        // å»é™¤é¦–å°¾ç©ºæ ¼
        @Expect(StringUtils.trim("  hello  "), "hello")
        @Expect(StringUtils.trim("\thello\n"), "hello")
        @Expect(StringUtils.trim("hello"), "hello")

        // å…¨æ˜¯ç©ºç™½
        @Expect(StringUtils.trim("  "), "")
        @Expect(StringUtils.trim("\t\n"), "")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.trim(""), "")

        // å•ä¾§ç©ºç™½
        @Expect(StringUtils.trim("  hello"), "hello")
        @Expect(StringUtils.trim("hello  "), "hello")
    }

    @TestCase
    func testSplit() {
        // åŸºæœ¬åˆ†å‰²
        let result1 = StringUtils.split("a,b,c", ",")
        @Expect(result1.size, 3)
        @Expect(result1[0], "a")
        @Expect(result1[1], "b")
        @Expect(result1[2], "c")

        // ç©ºå…ƒç´ 
        let result2 = StringUtils.split("a,,b", ",")
        @Expect(result2.size, 3)
        @Expect(result2[1], "")

        // ç©ºå­—ç¬¦ä¸²
        let result3 = StringUtils.split("", ",")
        @Expect(result3.size, 1)
        @Expect(result3[0], "")

        // æ— åˆ†éš”ç¬¦
        let result4 = StringUtils.split("hello", ",")
        @Expect(result4.size, 1)
        @Expect(result4[0], "hello")
    }

    @TestCase
    func testJoin() {
        // åŸºæœ¬è¿æ¥
        @Expect(StringUtils.join(["a", "b", "c"], ","), "a,b,c")

        // å•ä¸ªå…ƒç´ 
        @Expect(StringUtils.join(["a"], ","), "a")

        // ç©ºæ•°ç»„
        @Expect(StringUtils.join([], ","), "")

        // ä¸åŒåˆ†éš”ç¬¦
        @Expect(StringUtils.join(["a", "b"], "-"), "a-b")
        @Expect(StringUtils.join(["a", "b"], " "), "a b")
    }

    // ========== Phase 3: å¤§å°å†™è½¬æ¢æµ‹è¯• ==========

    @TestCase
    func testUpperCase() {
        // åŸºæœ¬è½¬æ¢
        @Expect(StringUtils.upperCase("hello"), "HELLO")
        @Expect(StringUtils.upperCase("HELLO"), "HELLO")
        @Expect(StringUtils.upperCase("HeLLo"), "HELLO")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.upperCase(""), "")

        // æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦
        @Expect(StringUtils.upperCase("123"), "123")
        @Expect(StringUtils.upperCase("hello123"), "HELLO123")
        @Expect(StringUtils.upperCase("hello-world"), "HELLO-WORLD")
    }

    @TestCase
    func testLowerCase() {
        // åŸºæœ¬è½¬æ¢
        @Expect(StringUtils.lowerCase("HELLO"), "hello")
        @Expect(StringUtils.lowerCase("hello"), "hello")
        @Expect(StringUtils.lowerCase("HeLLo"), "hello")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.lowerCase(""), "")

        // æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦
        @Expect(StringUtils.lowerCase("123"), "123")
        @Expect(StringUtils.lowerCase("HELLO123"), "hello123")
        @Expect(StringUtils.lowerCase("HELLO-WORLD"), "hello-world")
    }

    @TestCase
    func testCapitalize() {
        // åŸºæœ¬è½¬æ¢
        @Expect(StringUtils.capitalize("hello"), "Hello")
        @Expect(StringUtils.capitalize("HELLO"), "HELLO")
        @Expect(StringUtils.capitalize("hELLO"), "HELLO")

        // ç©ºå­—ç¬¦ä¸²å’Œå•å­—ç¬¦
        @Expect(StringUtils.capitalize(""), "")
        @Expect(StringUtils.capitalize("a"), "A")
        @Expect(StringUtils.capitalize("A"), "A")

        // å·²å¤§å†™
        @Expect(StringUtils.capitalize("Hello"), "Hello")

        // ç©ºæ ¼å¼€å¤´
        @Expect(StringUtils.capitalize(" hello"), " hello")
    }

    @TestCase
    func testUncapitalize() {
        // åŸºæœ¬è½¬æ¢
        @Expect(StringUtils.uncapitalize("Hello"), "hello")
        @Expect(StringUtils.uncapitalize("HELLO"), "hELLO")
        @Expect(StringUtils.uncapitalize("hello"), "hello")

        // ç©ºå­—ç¬¦ä¸²å’Œå•å­—ç¬¦
        @Expect(StringUtils.uncapitalize(""), "")
        @Expect(StringUtils.uncapitalize("A"), "a")
        @Expect(StringUtils.uncapitalize("a"), "a")

        // å·²å°å†™
        @Expect(StringUtils.uncapitalize("hello"), "hello")
    }

    @TestCase
    func testSwapCase() {
        // åŸºæœ¬è½¬æ¢
        @Expect(StringUtils.swapCase("Hello"), "hELLO")
        @Expect(StringUtils.swapCase("HELLO"), "hello")
        @Expect(StringUtils.swapCase("hello"), "HELLO")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.swapCase(""), "")

        // æ··åˆ
        @Expect(StringUtils.swapCase("HeLLo WoRLd"), "hEllO wOrlD")

        // æ•°å­—å’Œç‰¹æ®Šå­—ç¬¦ä¸å˜
        @Expect(StringUtils.swapCase("hello123"), "HELLO123")
        @Expect(StringUtils.swapCase("hello-world"), "HELLO-WORLD")
    }

    // ========== Phase 4: æŸ¥è¯¢ä¸æ¯”è¾ƒæµ‹è¯• ==========

    @TestCase
    func testEquals() {
        // ç›¸ç­‰
        @Expect(StringUtils.equals("hello", "hello"), true)
        @Expect(StringUtils.equals("", ""), true)

        // ä¸ç›¸ç­‰
        @Expect(StringUtils.equals("hello", "HELLO"), false)
        @Expect(StringUtils.equals("hello", "world"), false)
        @Expect(StringUtils.equals("", "hello"), false)
    }

    @TestCase
    func testCompare() {
        // å°äº
        @Expect(StringUtils.compare("a", "b") < 0, true)
        @Expect(StringUtils.compare("A", "a") < 0, true)

        // å¤§äº
        @Expect(StringUtils.compare("b", "a") > 0, true)
        @Expect(StringUtils.compare("a", "A") > 0, true)

        // ç›¸ç­‰
        @Expect(StringUtils.compare("a", "a"), 0)
        @Expect(StringUtils.compare("", ""), 0)
    }

    @TestCase
    func testContains() {
        // åŒ…å«
        @Expect(StringUtils.contains("hello", "ell"), true)
        @Expect(StringUtils.contains("hello", "hello"), true)
        @Expect(StringUtils.contains("hello", ""), true)

        // ä¸åŒ…å«
        @Expect(StringUtils.contains("hello", "abc"), false)
        @Expect(StringUtils.contains("hello", "xyz"), false)
        @Expect(StringUtils.contains("", "a"), false)
    }

    @TestCase
    func testStartsWith() {
        // åŒ¹é…
        @Expect(StringUtils.startsWith("hello", "hel"), true)
        @Expect(StringUtils.startsWith("hello", "h"), true)
        @Expect(StringUtils.startsWith("hello", "hello"), true)
        @Expect(StringUtils.startsWith("", ""), true)

        // ä¸åŒ¹é…
        @Expect(StringUtils.startsWith("hello", "ell"), false)
        @Expect(StringUtils.startsWith("hello", "world"), false)
        @Expect(StringUtils.startsWith("hello", "hello world"), false)
    }

    @TestCase
    func testEndsWith() {
        // åŒ¹é…
        @Expect(StringUtils.endsWith("hello", "llo"), true)
        @Expect(StringUtils.endsWith("hello", "o"), true)
        @Expect(StringUtils.endsWith("hello", "hello"), true)
        @Expect(StringUtils.endsWith("", ""), true)

        // ä¸åŒ¹é…
        @Expect(StringUtils.endsWith("hello", "ell"), false)
        @Expect(StringUtils.endsWith("hello", "world"), false)
        @Expect(StringUtils.endsWith("hello", "hello world"), false)
    }

    @TestCase
    func testIndexOf() {
        // æ‰¾åˆ°
        @Expect(StringUtils.indexOf("hello", "ell"), 1)
        @Expect(StringUtils.indexOf("hello", "h"), 0)
        @Expect(StringUtils.indexOf("hello", "o"), 4)
        @Expect(StringUtils.indexOf("hello", ""), 0)

        // æœªæ‰¾åˆ°
        @Expect(StringUtils.indexOf("hello", "abc"), StringUtils.INDEX_NOT_FOUND)
        @Expect(StringUtils.indexOf("", "a"), StringUtils.INDEX_NOT_FOUND)
    }

    @TestCase
    func testLastIndexOf() {
        // æ‰¾åˆ°
        @Expect(StringUtils.lastIndexOf("hello hello", "ell"), 7)
        @Expect(StringUtils.lastIndexOf("hello", "l"), 3)
        @Expect(StringUtils.lastIndexOf("hello", ""), 5)

        // æœªæ‰¾åˆ°
        @Expect(StringUtils.lastIndexOf("hello", "abc"), StringUtils.INDEX_NOT_FOUND)
        @Expect(StringUtils.lastIndexOf("", "a"), StringUtils.INDEX_NOT_FOUND)
    }

    // ========== Phase 5: æ›¿æ¢ä¸åˆ é™¤æµ‹è¯• ==========

    @TestCase
    func testReplace() {
        // åŸºæœ¬æ›¿æ¢
        @Expect(StringUtils.replace("hello", "l", "x"), "hexxo")
        @Expect(StringUtils.replace("hello", "ell", "abc"), "habco")

        // æœªæ‰¾åˆ°
        @Expect(StringUtils.replace("hello", "xyz", "abc"), "hello")

        // å¤šæ¬¡æ›¿æ¢
        @Expect(StringUtils.replace("hello", "l", ""), "heo")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.replace("", "a", "b"), "")
        @Expect(StringUtils.replace("hello", "", "x"), "hello")
    }

    @TestCase
    func testReplaceOnce() {
        // åŸºæœ¬æ›¿æ¢
        @Expect(StringUtils.replaceOnce("hello", "l", "x"), "hexlo")
        @Expect(StringUtils.replaceOnce("hello", "ell", "abc"), "habco")

        // æœªæ‰¾åˆ°
        @Expect(StringUtils.replaceOnce("hello", "xyz", "abc"), "hello")

        // åªæ›¿æ¢ç¬¬ä¸€ä¸ª
        @Expect(StringUtils.replaceOnce("hello", "l", ""), "helo")
    }

    @TestCase
    func testRemove() {
        // åŸºæœ¬åˆ é™¤
        @Expect(StringUtils.remove("hello", "l"), "heo")
        @Expect(StringUtils.remove("hello", "ell"), "ho")

        // æœªæ‰¾åˆ°
        @Expect(StringUtils.remove("hello", "xyz"), "hello")

        // åˆ é™¤æ‰€æœ‰
        @Expect(StringUtils.remove("aaa", "a"), "")
    }

    // ========== Phase 6: å¡«å……ä¸å¯¹é½æµ‹è¯• ==========

    @TestCase
    func testLeftPad() {
        // åŸºæœ¬å¡«å……ï¼ˆä½¿ç”¨ç©ºæ ¼ï¼‰
        @Expect(StringUtils.leftPad("hello", 10), "     hello")

        // ä¸éœ€è¦å¡«å……
        @Expect(StringUtils.leftPad("hello", 3), "hello")
        @Expect(StringUtils.leftPad("hello", 5), "hello")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.leftPad("", 5), "     ")

        // ä½¿ç”¨è‡ªå®šä¹‰å­—ç¬¦
        @Expect(StringUtils.leftPad("hello", 10, r'*'), "*****hello")
        @Expect(StringUtils.leftPad("hello", 10, r'0'), "00000hello")
    }

    @TestCase
    func testRightPad() {
        // åŸºæœ¬å¡«å……ï¼ˆä½¿ç”¨ç©ºæ ¼ï¼‰
        @Expect(StringUtils.rightPad("hello", 10), "hello     ")

        // ä¸éœ€è¦å¡«å……
        @Expect(StringUtils.rightPad("hello", 3), "hello")
        @Expect(StringUtils.rightPad("hello", 5), "hello")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.rightPad("", 5), "     ")

        // ä½¿ç”¨è‡ªå®šä¹‰å­—ç¬¦
        @Expect(StringUtils.rightPad("hello", 10, r'*'), "hello*****")
        @Expect(StringUtils.rightPad("hello", 10, r'0'), "hello00000")
    }

    @TestCase
    func testCenter() {
        // åŸºæœ¬å±…ä¸­
        // hello(5) -> size 11 -> pad 6 -> left 3, right 3 -> "   hello   "
        @Expect(StringUtils.center("hello", 11), "   hello   ")
        // hello(5) -> size 10 -> pad 5 -> left 2, right 3 -> "  hello   "
        @Expect(StringUtils.center("hello", 10), "  hello   ")

        // ä¸éœ€è¦å¡«å……
        @Expect(StringUtils.center("hello", 3), "hello")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.center("", 5), "     ")
    }

    @TestCase
    func testRepeat() {
        // åŸºæœ¬é‡å¤
        @Expect(StringUtils.repeat("a", 3), "aaa")
        @Expect(StringUtils.repeat("ab", 2), "abab")

        // è¾¹ç•Œæƒ…å†µ
        @Expect(StringUtils.repeat("a", 0), "")
        @Expect(StringUtils.repeat("", 3), "")
        @Expect(StringUtils.repeat("a", 1), "a")
    }

    // ========== Phase 7: æˆªå–æµ‹è¯• ==========

    @TestCase
    func testSubstringOneParam() {
        // åŸºæœ¬æˆªå–
        @Expect(StringUtils.substring("hello", 2), "llo")
        @Expect(StringUtils.substring("hello", 0), "hello")

        // è¾¹ç•Œæƒ…å†µ
        @Expect(StringUtils.substring("hello", 5), "")
        @Expect(StringUtils.substring("hello", 10), "")
    }

    @TestCase
    func testSubstringTwoParams() {
        // åŸºæœ¬æˆªå–
        @Expect(StringUtils.substring("hello", 1, 4), "ell")
        @Expect(StringUtils.substring("hello", 0, 5), "hello")

        // è¾¹ç•Œæƒ…å†µ
        @Expect(StringUtils.substring("hello", 2, 2), "")
        @Expect(StringUtils.substring("hello", 2, 10), "llo")
    }

    @TestCase
    func testLeft() {
        // åŸºæœ¬æˆªå–
        @Expect(StringUtils.left("hello", 2), "he")
        @Expect(StringUtils.left("hello", 3), "hel")

        // è¾¹ç•Œæƒ…å†µ
        @Expect(StringUtils.left("hello", 0), "")
        @Expect(StringUtils.left("hello", 10), "hello")
        @Expect(StringUtils.left("", 5), "")
    }

    @TestCase
    func testRight() {
        // åŸºæœ¬æˆªå–
        @Expect(StringUtils.right("hello", 2), "lo")
        @Expect(StringUtils.right("hello", 3), "llo")

        // è¾¹ç•Œæƒ…å†µ
        @Expect(StringUtils.right("hello", 0), "")
        @Expect(StringUtils.right("hello", 10), "hello")
        @Expect(StringUtils.right("", 5), "")
    }

    @TestCase
    func testMid() {
        // åŸºæœ¬æˆªå–
        @Expect(StringUtils.mid("hello", 1, 2), "el")
        @Expect(StringUtils.mid("hello", 0, 5), "hello")

        // è¶…å‡ºé•¿åº¦
        @Expect(StringUtils.mid("hello", 2, 10), "llo")

        // è¾¹ç•Œæƒ…å†µ
        @Expect(StringUtils.mid("hello", -1, 2), "")
        @Expect(StringUtils.mid("hello", 10, 2), "")
    }

    // ========== Phase 8: åè½¬æµ‹è¯• ==========

    @TestCase
    func testReverse() {
        // åŸºæœ¬åè½¬
        @Expect(StringUtils.reverse("hello"), "olleh")

        // è¾¹ç•Œæƒ…å†µ
        @Expect(StringUtils.reverse(""), "")
        @Expect(StringUtils.reverse("a"), "a")
        @Expect(StringUtils.reverse("ab"), "ba")
    }

    @TestCase
    func testReverseDelimited() {
        // åŸºæœ¬åè½¬
        @Expect(StringUtils.reverseDelimited("a.b.c", "."), "c.b.a")
        @Expect(StringUtils.reverseDelimited("a-b-c", "-"), "c-b-a")

        // æ— åˆ†éš”ç¬¦
        @Expect(StringUtils.reverseDelimited("hello", "."), "hello")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.reverseDelimited("", "."), "")
    }

    // ========== Phase 9: å…¶ä»–å®ç”¨æ–¹æ³•æµ‹è¯• ==========

    @TestCase
    func testCountMatches() {
        // åŸºæœ¬ç»Ÿè®¡
        @Expect(StringUtils.countMatches("hello", "l"), 2)
        @Expect(StringUtils.countMatches("hello", "ll"), 1)

        // æœªæ‰¾åˆ°
        @Expect(StringUtils.countMatches("hello", "x"), 0)

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.countMatches("", "a"), 0)
        @Expect(StringUtils.countMatches("hello", ""), 0)
    }

    @TestCase
    func testLeftTrim() {
        // åŸºæœ¬å»é™¤
        @Expect(StringUtils.leftTrim("  hello"), "hello")
        @Expect(StringUtils.leftTrim("hello  "), "hello  ")

        // ç‰¹æ®Šç©ºç™½å­—ç¬¦
        @Expect(StringUtils.leftTrim("\thello"), "hello")
        @Expect(StringUtils.leftTrim("\nhello"), "hello")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.leftTrim(""), "")
        @Expect(StringUtils.leftTrim("  "), "")
    }

    @TestCase
    func testRightTrim() {
        // åŸºæœ¬å»é™¤
        @Expect(StringUtils.rightTrim("hello  "), "hello")
        @Expect(StringUtils.rightTrim("  hello"), "  hello")

        // ç‰¹æ®Šç©ºç™½å­—ç¬¦
        @Expect(StringUtils.rightTrim("hello\t"), "hello")
        @Expect(StringUtils.rightTrim("hello\n"), "hello")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.rightTrim(""), "")
        @Expect(StringUtils.rightTrim("  "), "")
    }

    @TestCase
    func testSubstringBefore() {
        // åŸºæœ¬æˆªå–
        @Expect(StringUtils.substringBefore("hello@world", "@"), "hello")

        // æœªæ‰¾åˆ°åˆ†éš”ç¬¦
        @Expect(StringUtils.substringBefore("hello", "@"), "hello")

        // åœ¨å¼€å¤´
        @Expect(StringUtils.substringBefore("@world", "@"), "")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.substringBefore("", "@"), "")
    }

    @TestCase
    func testSubstringAfter() {
        // åŸºæœ¬æˆªå–
        @Expect(StringUtils.substringAfter("hello@world", "@"), "world")

        // æœªæ‰¾åˆ°åˆ†éš”ç¬¦
        @Expect(StringUtils.substringAfter("hello", "@"), "")

        // åœ¨å¼€å¤´
        @Expect(StringUtils.substringAfter("@world", "@"), "world")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.substringAfter("", "@"), "")
    }

    @TestCase
    func testSubstringBetweenTwoTags() {
        // åŸºæœ¬æˆªå–
        @Expect(StringUtils.substringBetween("hello[world]", "[", "]"), "world")

        // æœªæ‰¾åˆ°
        @Expect(StringUtils.substringBetween("hello", "[", "]"), "")

        // åœ¨å¼€å¤´å’Œç»“å°¾
        @Expect(StringUtils.substringBetween("[hello]", "[", "]"), "hello")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.substringBetween("", "[", "]"), "")
    }

    @TestCase
    func testSubstringBetweenOneTag() {
        // åŸºæœ¬æˆªå–
        @Expect(StringUtils.substringBetween("hello'world'", "'"), "world")

        // æœªæ‰¾åˆ°
        @Expect(StringUtils.substringBetween("hello", "'"), "")

        // åœ¨å¼€å¤´å’Œç»“å°¾
        @Expect(StringUtils.substringBetween("'hello'", "'"), "hello")
    }

    @TestCase
    func testIsAlpha() {
        // çº¯å­—æ¯
        @Expect(StringUtils.isAlpha("abc"), true)
        @Expect(StringUtils.isAlpha("ABC"), true)
        @Expect(StringUtils.isAlpha("AbCd"), true)

        // éçº¯å­—æ¯
        @Expect(StringUtils.isAlpha("abc123"), false)
        @Expect(StringUtils.isAlpha("123"), false)
        @Expect(StringUtils.isAlpha(""), false)
        @Expect(StringUtils.isAlpha("abc def"), false)
    }

    @TestCase
    func testIsNumeric() {
        // çº¯æ•°å­—
        @Expect(StringUtils.isNumeric("123"), true)
        @Expect(StringUtils.isNumeric("0"), true)

        // éçº¯æ•°å­—
        @Expect(StringUtils.isNumeric("123abc"), false)
        @Expect(StringUtils.isNumeric("abc"), false)
        @Expect(StringUtils.isNumeric(""), false)
        @Expect(StringUtils.isNumeric("12.3"), false)
    }

    @TestCase
    func testIsAlphanumeric() {
        // å­—æ¯å’Œæ•°å­—ç»„åˆ
        @Expect(StringUtils.isAlphanumeric("abc123"), true)
        @Expect(StringUtils.isAlphanumeric("123abc"), true)
        @Expect(StringUtils.isAlphanumeric("abc"), true)
        @Expect(StringUtils.isAlphanumeric("123"), true)

        // éå­—æ¯æ•°å­—
        @Expect(StringUtils.isAlphanumeric("abc-123"), false)
        @Expect(StringUtils.isAlphanumeric(""), false)
        @Expect(StringUtils.isAlphanumeric("abc 123"), false)
    }

    // ========== Phase 12: ç¼©ç•¥ä¸æ—‹è½¬æµ‹è¯• ==========

    @TestCase
    func testAbbreviate() {
        // åŸºæœ¬ç¼©ç•¥
        @Expect(StringUtils.abbreviate("abcdefg", 6), "abc...")
        @Expect(StringUtils.abbreviate("abcdefg", 7), "abcdefg")
        @Expect(StringUtils.abbreviate("abcdefg", 8), "abcdefg")
        @Expect(StringUtils.abbreviate("abcdefg", 4), "a...")

        // è¾¹ç•Œæµ‹è¯•
        // width = 4 (min allowed)
        @Expect(StringUtils.abbreviate("abcdefg", 4), "a...")

        // width = length (must be >= 4)
        @Expect(StringUtils.abbreviate("abcd", 4), "abcd")

        // width > length
        @Expect(StringUtils.abbreviate("abc", 10), "abc")

        // ç©ºå­—ç¬¦ä¸²
        @Expect(StringUtils.abbreviate("", 4), "")

        // å¼‚å¸¸æƒ…å†µ
        @ExpectThrows[IllegalArgumentException](StringUtils.abbreviate("abc", 3))
    }

    @TestCase
    func testAbbreviateExtended() {
        let str = "abcdefghij" // length 10

        // maxWidth = 4
        @Expect(StringUtils.abbreviate(str, 4), "a...")

        // maxWidth = 5
        @Expect(StringUtils.abbreviate(str, 5), "ab...")

        // maxWidth = length
        @Expect(StringUtils.abbreviate(str, 10), str)

        // maxWidth > length
        @Expect(StringUtils.abbreviate(str, 100), str)

        // maxWidth just enough for ellipsis
        // If str is "abc", len 3, maxWidth 4 -> "abc" (since len <= maxWidth)
        @Expect(StringUtils.abbreviate("abc", 4), "abc")
    }

    @TestCase
    func testRotate() {
        // å³ç§»
        @Expect(StringUtils.rotate("abcdefg", 2), "fgabcde")
        @Expect(StringUtils.rotate("abcdefg", 7), "abcdefg")
        @Expect(StringUtils.rotate("abcdefg", 9), "fgabcde")

        // å·¦ç§»
        @Expect(StringUtils.rotate("abcdefg", -2), "cdefgab")
        @Expect(StringUtils.rotate("abcdefg", -7), "abcdefg")
        @Expect(StringUtils.rotate("abcdefg", -9), "cdefgab")

        // ä¸ç§»
        @Expect(StringUtils.rotate("abcdefg", 0), "abcdefg")
        @Expect(StringUtils.rotate("", 2), "")

        // Unicode æ”¯æŒ
        @Expect(StringUtils.rotate("ä½ å¥½ä¸–ç•Œ", 1), "ç•Œä½ å¥½ä¸–")

        // Emoji æµ‹è¯•
        let emojiStr = "ABğŸ˜ŠCD"
        // Rotate 1 -> "DABğŸ˜ŠC"
        @Expect(StringUtils.rotate(emojiStr, 1), "DABğŸ˜ŠC")
        // Rotate 2 -> "CDABğŸ˜Š"
        @Expect(StringUtils.rotate(emojiStr, 2), "CDABğŸ˜Š")
    }

    @TestCase
    func testRotateExtended() {
        let str = "abcdefg"

        // 1. Shift > length
        @Expect(StringUtils.rotate(str, 8), "gabcdef") // 8 % 7 = 1
        @Expect(StringUtils.rotate(str, 14), "abcdefg") // 14 % 7 = 0

        // 2. Shift negative large
        @Expect(StringUtils.rotate(str, -8), "bcdefga") // -8 % 7 = -1 -> left 1

        // 3. Empty string
        @Expect(StringUtils.rotate("", 5), "")

        // 4. Shift = 0
        @Expect(StringUtils.rotate(str, 0), "abcdefg")

        // 5. Shift = length
        @Expect(StringUtils.rotate(str, 7), "abcdefg")

        // 6. Single char
        @Expect(StringUtils.rotate("a", 100), "a")
    }

    // ========== å¸¸é‡æµ‹è¯• ==========

    @TestCase
    func testConstants() {
        @Expect(StringUtils.EMPTY, "")
        @Expect(StringUtils.INDEX_NOT_FOUND, -1)
    }
}
